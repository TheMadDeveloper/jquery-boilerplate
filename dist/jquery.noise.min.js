/*
 *  jQuery Noise - v0.2.0
 *  A widget for rendering and displaying noise/static animations via html5 canvas. Depends on the jQueryUI widget factory.
 *  
 *
 *  Made by Keith Kerlan
 *  Under MIT License
 */
!function(a){a.widget("k3.graphic",{options:{animates:!1},_create:function(){var a=this.element;this._width=a.width(),this._height=a.height(),this._is("IMG")?this._initImg():this._is("CANVAS")&&(this.$canvas=a)},_initImg:function(){this.$img=this.element},_initCanvas:function(b){var c=a("<canvas>").attr({width:this._width,height:this._height});return b&&this.$img&&c.get(0).getContext("2d").drawImage(this.$img[0],0,0),c},draw:function(){this.option("animates")?(this._t=0,this._rate=this.option("frame_rate")||1,this.redraw()):this._render()},redraw:function(){var a=this;this._t%this._rate===0&&a._render(this._t),this._t++,a.anim_id=requestAnimationFrame(function(){a.redraw.apply(a)})},_render:function(){},convertCanvas:function(){this._is("CANVAS")||(this.$canvas=this._createCanvas(),this.element.replaceWith(this.$canvas),this.element=this.$canvas,this._ctx=this.$canvas.get(0).getContext("2d"))},_createCanvas:function(){return a("<canvas>").attr({width:this._width,height:this._height})},_is:function(a){return a===this.element.prop("tagName")},getImageData:function(){var a=this.getContext();return a.drawImage(this.$img[0],0,0),a.getImageData(0,0,this._width,this._height)},getContext:function(){return this._is("CANVAS")?(this._ctx||(this._ctx=this.element.get(0).getContext("2d")),this._ctx):this._is("IMG")?this._createCanvas().get(0).getContext("2d"):void 0},destroy:function(){a.Widget.prototype.destroy.call(this)},_canvasImage:function(){var a=$canvas.get(0).toDataURL();return $img.attr("src",a),this.element.trigger("svg:rendered",[a,$img]),$img},_getContext:function(){return this._ctx?this._ctx:(this.$img&&(this.$canvas=this._initCanvas(!0)),this.$canvas?(this._ctx=this.$canvas[0].getContext("2d"),this._ctx):void 0)},_setPixel:function(a,b,c){for(var d=0;4>d;d++)a[b+d]=c[d]}})}(jQuery,window,document),function(a){a.widget("k3.graphic",{options:{animates:!1},_create:function(){var a=this.element;this._width=a.width(),this._height=a.height(),this._is("IMG")?this._initImg():this._is("CANVAS")&&(this.$canvas=a)},_initImg:function(){this.$img=this.element},_initCanvas:function(b){var c=a("<canvas>").attr({width:this._width,height:this._height});return b&&this.$img&&c.get(0).getContext("2d").drawImage(this.$img[0],0,0),c},draw:function(){this.option("animates")?(this._t=0,this._rate=this.option("frame_rate")||1,this.redraw()):this._render()},redraw:function(){var a=this;this._t%this._rate===0&&a._render(this._t),this._t++,a.anim_id=requestAnimationFrame(function(){a.redraw.apply(a)})},_render:function(){},convertCanvas:function(){this._is("CANVAS")||(this.$canvas=this._createCanvas(),this.element.replaceWith(this.$canvas),this.element=this.$canvas,this._ctx=this.$canvas.get(0).getContext("2d"))},_createCanvas:function(){return a("<canvas>").attr({width:this._width,height:this._height})},_is:function(a){return a===this.element.prop("tagName")},getImageData:function(){var a=this.getContext();return a.drawImage(this.$img[0],0,0),a.getImageData(0,0,this._width,this._height)},getContext:function(){return this._is("CANVAS")?(this._ctx||(this._ctx=this.element.get(0).getContext("2d")),this._ctx):this._is("IMG")?this._createCanvas().get(0).getContext("2d"):void 0},destroy:function(){a.Widget.prototype.destroy.call(this)},_canvasImage:function(){var a=$canvas.get(0).toDataURL();return $img.attr("src",a),this.element.trigger("svg:rendered",[a,$img]),$img},_getContext:function(){return this._ctx?this._ctx:(this.$img&&(this.$canvas=this._initCanvas(!0)),this.$canvas?(this._ctx=this.$canvas[0].getContext("2d"),this._ctx):void 0)},_setPixel:function(a,b,c){for(var d=0;4>d;d++)a[b+d]=c[d]}})}(jQuery,window,document),function(a){a.widget("k3.noise",a.k3.graphic,{options:{c1:[255,255,255,255],c2:[0,0,0,255],frames:32,animates:{}},_create:function(){this._super(),this.frame_count=this.option("frames"),this._noise_frames=[];for(var a=this.frame_count;a>0;a--)this._noise_frames.push(this._renderNoiseFrame());this.draw()},_initImg:function(){this._super(),this.option("mask",this.getImageData()),this.convertCanvas()},destroy:function(){a.Widget.prototype.destroy.call(this)},_render:function(a){a=a||0,this.getContext().putImageData(this._noise_frames[a%this.frame_count],0,0)},_renderNoiseFrame:function(a,b){var c=this.getContext().createImageData(this._width,this._height),d=this.option("mask");a=a||this.option("c1"),b=b||this.option("c2");for(var e=0,f=c.data.length;f>e;e+=4)d?d.data[e+3]>0&&this._setPixel(c.data,e,Math.random()<.5?a:b):this._setPixel(c.data,e,Math.random()<.5?a:b);return c}})}(jQuery,window,document);